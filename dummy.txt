Minor bug fixes - 1731683815.921006
Refactored code - 1731683817.1287355
